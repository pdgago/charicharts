<!DOCTYPE html>
<html>
<head>
  <title>Charicharts Demo</title>
  <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore.js"></script>
  <script src="http://d3js.org/d3.v3.js"></script>
  <script src="charicharts.js"></script>

  <style type="text/css">
    body {
      font-family: 'Helvetica', sans-serif;
      font-size: 13px;
    }

    #chart {
      height: 500px;
      width: 500px;
    }

    .line {
      fill: transparent;
      stroke-width: 2px;
    }

    rect {
      shape-rendering: crispEdges;
    }

    .trail-line {
      stroke: black;
      shape-rendering: crispEdges;
      stroke-width: 1px;
    }

    text {
      fill: #777;
    }

    .yaxis line {
      stroke: #ccc;
      shape-rendering: crispEdges;
      stroke-dasharray: 10, 4;
    }

    .yaxis .tick:first-child line {
      stroke-dasharray: none;
      stroke: #ccc;
    }
  </style>

</head>
<body>

  <div id="chart"></div>
  <div>
    <div class='1004'>Wins</div>
    <div class='1005'>Losses</div>
    <div class='1006'>Gross</div>
  </div>

  <div id='add'>Add new serie</div>

  <script type="text/javascript">
    window.onload = function() {

      var getData = function () {
        return _.map(_.range(23), function(hour) {
          var date = new Date();
          date.setHours(hour+1, 0, 0, 0);
          return {
            value: _.random(400, 1000),
            datetime: date
          }
        });
      };

      var options = {
        target: document.getElementById('chart'),
        margin: '0,10,35,35',
        trail: true,
        yaxis: {
          fit: false,
          textAnchor: 'start',
          textMarginTop: -10
        },
        data: [{
          id: 1004,
          type: 'line',
          values: getData(),
          interpolation: 'step',
          color: 'orange',
        },{
          id: 1005,
          type: 'line',
          values: getData(),
          interpolation: 'cardinal',
          color: 'red'
        },{
          id: 1006,
          type: 'bar',
          values: getData(),
          color: '#ddd'
        }].reverse()
      };

      var chart = new Charicharts.Chart(options);

      var legends = _.pluck(options.data, 'id');

      legends.forEach(function(name) {
        document.getElementsByClassName(name)[0]
          .addEventListener('click', function() {
            chart.toggleSerie(name);
          });
      });


      document.getElementById('add')
        .addEventListener('click', function() {
          chart.addSerie({
            id: _.random(0, 3030),
            type: ['line', 'bar'][_.random(0,1)],
            values: getData(),
            color: 'green'
          })
        });
    };
  </script>

</body>
</html>